<link rel="import" href="../3rdparty/polymer.min.html"/><link rel="import" href="../3rdparty/lodash.min.html"/><dom-module id="xc-pi"><template>{{pistr}}</template><script>"use strict";!function(){function i(i){this.d=new Array(i),this.m=i;for(var t=i;t>=0;t--)this.d[t]=0}window.xc=window.xc||{};var t=function e(i,t,r,n){if(i.d[0]<0){var d=i.copy();i.invertSign();var o=t.copy();return t.invertSign(),"-"+e(d,o)}for(var s=i.d[0]+".",a=1;a<=i.m-r&&i.d[a]===t.d[a];a++)s+=i.d[a],n&&a%10===0&&(s+=" ");return s},r=function(i,t){if(i.m!==t.m)return 0;for(var r=i.m;r>=0;r--)if(i.d[r]!==t.d[r])return 0;return 1};i.prototype.copy=function(){for(var t=new i(this.m),r=this.m;r>=0;r--)t.d[r]=this.d[r];return t},i.prototype.toString=function(i){if(this.d[0]<0){var t=this.copy();return t.invertSign(),"-"+t.toString()}for(var r=this.d[0]+".",n=1;n<=this.m;n++)r+=this.d[n],i&&n%10===0&&(r+=" ");return r},i.prototype.setValue=function(i){for(var t=i,r=0;r<=this.m;r++)this.d[r]=Math.floor(t),t-=this.d[r],t*=10},i.prototype.invertSign=function(){for(var i=0;i<=this.m;i++){this.d[i]*=-1;for(var t=i;this.d[t]<0&&t>0;t--)this.d[t]+=10,this.d[t-1]--}},i.prototype.addDecimal=function(i){for(var t=this.m;t>=0;t--)this.d[t]+=i.d[t],this.d[t]>=10&&t>0&&(this.d[t]-=10,this.d[t-1]++)},i.prototype.divideInt=function(i){for(var t=0,r=0;r<=this.m;r++){t+=this.d[r];var n=Math.floor(t/i);this.d[r]=n,t=10*(t-n*i)}};var n=function(n,e,d){var o=0,s=new i(n+10),a=new i(n+10);a.setValue(16),a.divideInt(5);var v=new i(n+10);v.setValue(-4),v.divideInt(239);var c=function h(){var i=a.copy();i.divideInt(2*o+1);var n=v.copy();n.divideInt(2*o+1);var c=s.copy();if(s.addDecimal(i),s.addDecimal(n),a.invertSign(),a.divideInt(25),v.invertSign(),v.divideInt(57121),o++,r(s,c)){var u=t(s,c,10,e).trim();console.log("pi =",u),d(u)}else h()};c()};window.xc.Pi={properties:{padded:{type:Boolean,value:!1,observer:"_calculate"},digits:{type:Number,value:10,observer:"_calculate"},pistr:{type:String}},_calculate:function(){var i=this;if(_.isNumber(this.digits)&&!(this.digits<0)){if(this.digits<=10)return void(this.pistr="3.1415926535".slice(0,2+this.digits));this.busy=!0,n(this.digits,this.padded,function(t){i.pistr=t,i.busy=!1})}},calculate:n},Polymer({is:"xc-pi",behaviors:[window.xc.Pi]})}();</script></dom-module>